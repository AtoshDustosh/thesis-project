# Stage 2 Objectives

## 问题

有些细节方面还不清楚要如何实现, 因为担心直接开工可能导致日后一些麻烦等问题, 所以想先向老师问一下

### 1. 数据文件的获取和使用
- [ ] 数据文件类型的确认
- fna: 参考基因组序列文件(单纯的碱基序列)
- fastq: 测序数据文件(reads的碱基序列,以及对应的测序质量)
- sam/bam: fastq的比对数据文件
- vcf/bcf: 变异信息数据文件

**问题:** 之前老师发过一个vcf文件(很大, 1G多, 里面看起来像是人类的变异信息). 不过其它的数据文件要使用哪里的呢? 是只要是成套的数据就可以用吗?  
目前我的想法是去NCBI上找个人类基因组的碱基序列文件(fna那种格式的)用, 但是vcf具体要用哪些呢? 另外, 测序数据文件也是从NCBI上下载吗? 之前搜索到的信息里有提到过一个SRA数据库, 可以从那里下载测序数据. 比对数据文件(\*.sam)可以直接用其它方式生成吗?比如用samtools把测序数据和参考基因组比对一下生成比对数据文件之类的. 


### 2. 算法的设计方面

#### 1. 流程的确认

- [ ] 流程确认\[最初确定的步骤\]

1. 读入各类数据文件
2. 在参考基因组上找出变异数据的位置并标记
3. 采取不同策略将变异数据整合到参考基因组上, 然后分情况解决比对结果差的reads的比对问题, 具体分 "基于CIGAR信息的局部比对" 和 "给予比对位置信息的局部比对" 两类情况. 

**问题:** 

1. 首先想确认一下具体的流程, 我担心可能有偏差 ...
2. 这一部分是直接按照老师您之前说的步骤来实现代码就可以吗? 是否需要其他方面的修改?
3. 目前对流程方面已经有比较清楚的认识了, 不过对于一些细节部分不太清楚具体应该怎么做.  
比如"基于比对位置信息的局部比对方法"这一部分, 当初说明的时候所做的记录如下
(开题报告上也是这么写的):  
*组织全基因组上 SNP 和 SV 的变异信息，提取变异附近的局部序列，构建出局部的或
者是整体的 FM-index 压缩结构，然后对 read 进行常规的序列重比对.*  
我现在还不太理解这个局部序列提取及FM-index压缩结构的构建, 是像下面这样吗?  
···
把分散的变异数据整合到全基因组上, 之后依次将这些变异数据自身周围的局部序列(比如某个位点周围的±40bp范围内)提取出来, 并构建相应的FM-index压缩结构, 或者是直接将整个全基因组构建FM-index压缩结构.
···
然后关于这个FM-index压缩结构的使用, 是指构造一个BWT格式的索引然后用它去重新比对reads吗? 这样的话, 局部序列构造出的BWT要如何使用? 还是说这部分需要进一步设计?  
（；´д｀）ゞ
4. 比对结果差的reads的评判标准如何? 就是 ... 比对结果差到什么程度才能算是 "比对结果差" 呢? 比对结果里除了M(匹配), I(插入), D(删除)这些, 还有S, P这些东西, 对它们要按照什么标准衡量? 



### 3. 关于项目本身的问题

#### 1. 注释的规范

这方面除了尽可能地详尽和尽可能地精简以外, 还有其它要求吗? 比如要不要避免使用中文?  
另外, 格式上像下面这样可以吗
```
/**
 * [what this function does]
 * 
 * @param arg1
 * @param arg2
 * ...
 * @return ...
 */
int func(int arg1, char *arg2, MyStruct *arg3, ...){
  /*
   * 对处理流程必要的说明, 尽可能避免过多注释
   */
  [procedure 1]
  // ...
  [procedure 2]
  return value;
}
```
#### 2. 代码的规范
1. 缩进方面的要求? 比如禁用tab, 使用2空格缩进之类的
2. 函数及变量命名的要求? 比如是用abcDefHij这种格式, 或者abc_def_hij这种格式, 还是用其它更加简洁清晰的格式?
3. 数据类型的问题. 像是uint32_t和uint16_t这种, 有没有什么限制?
4. 函数声明先后顺序的问题? 比如排序的问题, 因为目前没有找到对C语言文件中函数排序的比较好用的IDE, 所以想在一开始就按照某种规定好的顺序来, 以免日后函数多了不好找. 具体来说, 就像htslib源码里看到的那样, 一个文件中有很多的函数, 然后将它们按照功能和类型放到一起, 并用类似"/\*\*\*\*\*\*\*\*\*\*\*\*/"的注释隔开方便阅读

#### 3. 项目文件组织及编译运行的规范
1. 目前来说尽管觉得把所有的\*.c和\*.h文件放到一个文件夹下比较混乱, 不如分文件夹管理整洁, 但是因为也并没有带来太多麻烦, 所以打算先这么放着. 然后编译的时候直接 "gcc \*.c \*.h -o test -lhts" 就好了. 
2. 另外就是头文件和源文件的组织问题, 我对头文件的使用不太熟练, 只在之前做一个课程实验的时候用过, 当时发现这样子写挺整洁的, 所以打算在做毕设的时候沿用那套方法. 但是后来项目复杂起来之后自己总是容易把它搞乱, 就上网找了点参考的头文件规范啥的, 不过也只是参考, 具体用起来根据情况调整.  
然后就是针对这个问题, 我发现我命名头文件的时候也挺容易混乱的, 比如哪个文件里的函数该干啥, 不该干啥, 往往做着做着, 两个文件的功能就互相掺杂了, 然后不得不把它们重新组织细分或是合并起来. 我想问一下老师, 这方面有什么要求吗? 
3. 使用命令行参数来选择相关功能这个是最后要实现的吗? 还是说一开始就考虑进去?
比如输入\-d表示要debug, 然后控制台打印一些信息之类的, 还有其它的一些参数设置之类的.